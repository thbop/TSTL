/*
* Copyright © 2025 Thbop
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy of
* this software and associated documentation files (the “Software”), to deal in
* the Software without restriction, including without limitation the rights to
* use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
* of the Software, and to permit persons to whom the Software is furnished to do
* so, subject to the following conditions:
* 
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/

#ifndef TSTL_STRING
#define TSTL_STRING

#include "string.h"

#include <TSTL/math>

namespace tstl {
    // Source: https://en.cppreference.com/w/cpp/string/basic_string.html

    class string {
    public:
        string();
        string( const char *str );
        string( const char *str, size_t count );
        string( const string &str );
        string( const string &str, size_t count );
        ~string();

        void operator=( const string &other );

        // TODO
        // void assign( const string &other );

        char at( size_t index );

        char operator[]( size_t index );

        char front();
        char back();
        
        const char *data() const;
        const char *c_str() const;

        // TODO
        // begin(), end(), rbegin(), rend()

        bool empty() const;

        size_t size() const;
        size_t length() const;

        // TODO
        // max_size

        void reserve( size_t new_capacity );

        size_t capacity() const;

        void shrink_to_fit();

        void clear();

        string &insert( size_t index, const char *str );
        string &insert( size_t index, const char *str, size_t count );
        string &insert( size_t index, const string &str );
        string &insert( size_t index, const string &str, size_t pos, size_t count );

        string &erase( size_t index, size_t count );

        void push_back( char ch );
        void pop_back();

        string &append( size_t count, char ch );
        string &append( const char *str );
        string &append( const char *str, size_t count );
        string &append( const string &str );
        string &append( const string &str, size_t pos, size_t count );

        string &operator+=( const string &str );
        string &operator+=( char ch );
        string &operator+=( const char *str );

        // TODO
        // replace(), copy(), resize(), swap()
        // find(), rfind(), find_first_of(), find_first_not_of(),
        // find_last_of(), find_last_not_of()

        int compare( const string &str ) const;
        int compare( size_t pos0, size_t count0, const string &str ) const;
        int compare( size_t pos0, size_t count0, const string &str, size_t pos1, size_t count1 ) const;
        int compare( const char *str ) const;
        int compare( size_t pos0, size_t count0, const char *str ) const;
        int compare( size_t pos0, size_t count0, const char *str, size_t pos1, size_t count1 ) const;

        bool starts_with( const char *str ) const;
        bool starts_with( const string &str ) const;

        bool ends_with( const char *str ) const;
        bool ends_with( const string &str ) const;

        bool contains( char ch ) const;
        bool contains( const char *str ) const;
        bool contains( const string &str ) const;

        string substr( size_t pos, size_t count ) const;
    
    private:
        char *buffer = nullptr;
        size_t
            buffer_size = 0,
            char_count   = 0;

        void set_buffer( const char *str, size_t count  );
        void set_buffer( const char *str );
    };
    
    string operator+( const char *a, const string b );
    string operator+( string a, const char *b );
    string operator+( string a, const string b );

    bool operator==( const char *a, const string b );
    bool operator==( const string a, const char *b );
    bool operator==( const string a, const string b );

    // TODO
    // stoi(), stol(), stoll(), stoul(), stoull()
    // stof(), stod(), stold(), to_string()
}

#endif